# QA Practice App - テスト練習用Webアプリケーション

## 概要

「QA Practice App」は、QAエンジニアが様々なテスト技法（同値分割、境界値分析、デシジョンテーブル、状態遷移テストなど）を実践的に学ぶための「テストの練習台」となるアプリケーションです。

本アプリケーションは、商品在庫管理システムとして実装されており、意図的に作り込まれた不具合やテストしがいのある仕様を通じて、品質保証のスキルセットを体系的に習得できる環境を提供します。

## 主な機能

### 基本機能
- **ユーザーログイン**: 管理者（admin）と一般ユーザー（user）の2種類の権限
- **商品CRUD操作**: 商品の登録、一覧表示、編集、削除
- **商品検索**: キーワード、カテゴリ、価格帯による複合検索

### テスト技法練習用の特別仕様

#### 1. 入力値バリデーション（同値分割・境界値分析用）
- **商品名**: 1文字以上、50文字以下
- **価格**: 0円以上、1,000,000円以下
- **在庫数**: 0個以上、999個以下

#### 2. 在庫ステータス表示（デシジョンテーブル用）
- 在庫数 = 0: 「在庫切れ」（背景色: 赤）
- 1 ≤ 在庫数 ≤ 10: 「残りわずか」（背景色: 黄）
- 在庫数 > 10: 「在庫あり」（背景色なし）

#### 3. 商品ステータス遷移（状態遷移テスト用）
- **新規登録時**: 「準備中」固定
- **「準備中」から**: 「公開中」または「非公開」に遷移可能
- **「公開中」から**: 「非公開」にのみ遷移可能
- **「非公開」から**: 「公開中」にのみ遷移可能

#### 4. 意図的な不具合（イースターエッグ）
- 検索キーワードに「バグ票」と入力すると500エラーが発生
- 商品説明欄でXSS（クロスサイトスクリプティング）が可能
- 商品削除ボタンに確認ダイアログがなく、即座に削除される

## 技術スタック

- **言語**: Python 3.x
- **Webフレームワーク**: Flask 3.0
- **データベース**: SQLite
- **テンプレートエンジン**: Jinja2

## 必要な環境

- Python 3.7以上
- pip（Pythonパッケージ管理ツール）

## インストールと起動方法

### 1. リポジトリのクローン

```bash
git clone https://github.com/nhnmomonga/qa-practice-app.git
cd qa-practice-app
```

### 2. 依存パッケージのインストール

```bash
pip install -r requirements.txt
```

### 3. アプリケーションの起動

```bash
python app.py
```

起動すると、以下のメッセージが表示されます：

```
データベースを初期化しました。
QA Practice App を起動します...
ブラウザで http://127.0.0.1:5000 にアクセスしてください。
ログイン情報:
  管理者 - ID: admin, PW: admin_password
  ユーザー - ID: user, PW: user_password
```

### 4. ブラウザでアクセス

ブラウザで `http://127.0.0.1:5000` にアクセスしてください。

## ログイン情報

### 管理者アカウント
- **ユーザーID**: `admin`
- **パスワード**: `admin_password`
- **権限**: 全ての商品に対するCRUD操作が可能

### 一般ユーザーアカウント
- **ユーザーID**: `user`
- **パスワード**: `user_password`
- **権限**: 商品の閲覧（R）と編集（U）のみ可能。削除（D）は不可

## データベースのリセット

データベースを初期状態に戻したい場合は、以下の手順を実行してください：

```bash
# データベースファイルを削除
rm database.db

# アプリケーションを再起動（自動的に初期化されます）
python app.py
```

## テスト自動化への配慮

全ての主要なHTML要素には、`data-testid`属性が付与されています。これにより、Selenium、Playwright、Cypressなどのテスト自動化ツールで要素を容易に特定できます。

### 主要な data-testid 属性

#### ログインページ
- `username-input`: ユーザーID入力欄
- `password-input`: パスワード入力欄
- `login-submit`: ログインボタン

#### 商品一覧ページ
- `search-form`: 検索フォーム
- `search-keyword`: キーワード検索入力欄
- `search-category`: カテゴリ選択
- `search-price-min`: 価格下限入力欄
- `search-price-max`: 価格上限入力欄
- `search-submit`: 検索ボタン
- `products-table`: 商品一覧テーブル
- `product-row-{id}`: 商品行（{id}は商品ID）
- `edit-button-{id}`: 編集ボタン
- `delete-button-{id}`: 削除ボタン

#### 商品登録・編集ページ
- `product-form`: 商品フォーム
- `product-name-input`: 商品名入力欄
- `product-category-select`: カテゴリ選択
- `product-price-input`: 価格入力欄
- `product-stock-input`: 在庫数入力欄
- `product-description-input`: 商品説明入力欄
- `status-preparing`: ステータス「準備中」
- `status-public`: ステータス「公開中」
- `status-private`: ステータス「非公開」
- `submit-button`: 送信ボタン
- `cancel-button`: キャンセルボタン

## テスト技法の練習例

### 1. 同値分割・境界値分析

価格フィールドに以下の値を入力してテストしてみましょう：

| 入力値 | 期待結果 | テスト観点 |
|--------|----------|------------|
| -1 | エラー | 境界値（下限未満） |
| 0 | 成功 | 境界値（下限） |
| 1 | 成功 | 有効値 |
| 500000 | 成功 | 有効値 |
| 1000000 | 成功 | 境界値（上限） |
| 1000001 | エラー | 境界値（上限超過） |
| "abc" | エラー | 無効値（文字列） |

### 2. デシジョンテーブル

在庫数による表示の変化をテストしてみましょう：

| 在庫数 | 表示テキスト | 背景色 |
|--------|--------------|--------|
| 0 | 在庫切れ | 赤 |
| 1 | 残りわずか | 黄 |
| 10 | 残りわずか | 黄 |
| 11 | 在庫あり | なし |
| 100 | 在庫あり | なし |

### 3. 状態遷移テスト

商品ステータスの遷移をテストしてみましょう：

```
準備中 → 公開中 ✓ （遷移可能）
準備中 → 非公開 ✓ （遷移可能）
公開中 → 非公開 ✓ （遷移可能）
公開中 → 準備中 ✗ （遷移不可）
非公開 → 公開中 ✓ （遷移可能）
非公開 → 準備中 ✗ （遷移不可）
```

### 4. エラー推測・セキュリティテスト

以下の不具合を探してみましょう：

1. 検索キーワードに「バグ票」と入力
   - → 500エラーが発生するはず

2. 商品説明欄に `<script>alert('XSS')</script>` を入力
   - → XSSの脆弱性が存在するはず

3. 商品削除ボタンをクリック
   - → 確認ダイアログなしで即座に削除されるはず

## プロジェクト構造

```
qa-practice-app/
├── app.py              # メインアプリケーション
├── requirements.txt    # Pythonパッケージの依存関係
├── database.db         # SQLiteデータベース（起動時に自動生成）
├── templates/          # HTMLテンプレート
│   ├── base.html      # 基本レイアウト
│   ├── login.html     # ログインページ
│   ├── products_list.html  # 商品一覧ページ
│   └── product_form.html   # 商品登録・編集ページ
├── PRD.md             # 製品要求仕様書
└── README.md          # このファイル
```

## 今後の展望

- REST APIエンドポイントの追加（APIテスト練習用）
- レスポンスが遅いAPIの実装（パフォーマンステスト練習用）
- CSVインポート・エクスポート機能

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 参考文献

本アプリケーションの開発は、t-wada氏が推奨するテスト駆動開発（TDD）の考え方を参考にしています。

- [t-wada氏のテスト関連資料](https://github.com/twada)

## 貢献

バグ報告や機能追加の提案は、GitHubのIssuesでお願いします。

---

**注意**: このアプリケーションは教育目的で作成されており、意図的にセキュリティ上の脆弱性や不具合が含まれています。本番環境では使用しないでください。
